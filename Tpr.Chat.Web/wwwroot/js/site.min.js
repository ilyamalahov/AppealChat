var helpInfoIsVisible,sideMenuIsVisible;const updateInfo=(n,t,i)=>$.post("update",{appealId:t}).done(i),getAccessToken=function(){return new Promise((n,t)=>{var i=sessionStorage.getItem("access_token");if(i)return n(i);$.post("token",{appealId:appealId,key:expertKey}).done(function(t){return sessionStorage.setItem("access_token",t.accessToken),n(t.accessToken)}).fail(t)})},messageTextKeyup=function(n){n.keyCode!==13||n.shiftKey||(n.preventDefault(),$(this).val().length>0&&sendMessage($(this).val()))},receiveMessage=(n,t)=>{const i=t?"Вы":n.nickName,r=luxon.DateTime.fromISO(n.createDate),u='<div class="message-bubble">'+n.messageString+"<\/div>",f=i+' <b class="message-date">'+r.toFormat("tt")+"<\/b>";return addMessage(u+f,!1,t)},joinMessage=function(n,t){const i=luxon.DateTime.fromISO(n.createDate),r=t?"Вы подключились к консультации":n.nickName+" подключился к консультации",u=r+' <b class="message-date">'+i.toFormat("tt")+"<\/b>";return addMessage(u,!0,t)},leaveMessage=(n,t)=>{const i=luxon.DateTime.fromISO(n.createDate),r=t?"Вы покинули консультацию":n.nickName+" покинул консультацию",u=r+' <b class="message-date">'+i.toFormat("tt")+"<\/b>";return addMessage(u,!0,t)},firstJoinExpertMessage=(n,t)=>{const i=n+" подключился к консультации. Вы можете задать ему свои вопросы";return addMessage(i,!0,t)},changeExpertMessage=n=>addMessage(n,!0,!0),addMessage=(n,t,i)=>{const u=$('<div class="message '+(i?"place-left":"place-right")+'"><\/div>').html(n);var r=$("<li><\/li>");return t&&r.addClass("message-status"),r.html(u)};jQuery.fn.scrollTo=function(n){return $(this).scrollTop($(this).scrollTop()-$(this).offset().top+$(n).offset().top),this};jQuery.fn.insertAtCursor=function(n){if($(this).prop("selectionStart")||$(this).prop("selectionStart")==="0"){var t=$(this).val().substring(0,$(this).prop("selectionStart")),i=$(this).val().substring($(this).prop("selectionEnd"),$(this).val().length);$(this).val(t+n+i)}else $(this).val($(this).val()+n);return this};jQuery.fn.highlightText=function(n){var t=$(this).text(),i=t.toLowerCase().indexOf(n.toLowerCase()),r=i+n.length,u=t.slice(0,i),f=t.slice(i,r),e=t.slice(r);return $(this).html(u+"<strong>"+f+"<\/strong>"+e),this};jQuery.fn.showModal=function(n,t){$.get(n,t,n=>$(this).html(n).show())};jQuery.fn.hideModal=function(){$(this).html("").hide()};jQuery.expr.filters.icontains=function(n,t,i){return(n.innerText||n.textContent||"").toLowerCase().indexOf(i[3].toLowerCase())>-1};const changeExpert=(n,t)=>new Promise((i,r)=>{$.ajax({method:"GET",url:"api/expert/change",headers:{Authorization:"Bearer "+n},beforeSend:t,success:i,error:r})}),calculateExpandRows=n=>{const t=n.dataset.minRows|1;n.rows=t;const i=Math.ceil((n.scrollHeight-n.clientHeight)/16);return Math.max(0,Math.min(i,4))};helpInfoIsVisible=!1;const switchHelpInfo=function(n){helpInfoIsVisible=n;var t={top:0,left:0};if(n){const n=$("#contactsTooltip").parent(),i=n.position().top+n.outerHeight()-$("#contactsTooltip").outerHeight(),r=n.position().left+n.outerWidth()+20;t={top:i,left:r}}$("#contactsTooltip").toggle(n).css(t)};sideMenuIsVisible=!1;const switchSideMenu=n=>{sideMenuIsVisible=n,$("#sideMenu").toggle(n)};$(document).ready(function(){$("#contactsButton").on("click",()=>switchHelpInfo(!helpInfoIsVisible));$("#closeHelpButton").on("click",()=>switchHelpInfo(!1));$("#sideMenuButton").on("click",()=>switchSideMenu(!sideMenuIsVisible));$("#closeSideButton").on("click",()=>switchSideMenu(!1));$("#appealInfoButton").on("click",()=>{switchSideMenu(!1),$("#modal").showModal("ajax/appealinfo",{appealId})})});$(document).on("click","#closeModalButton",()=>$("#modal").hideModal());