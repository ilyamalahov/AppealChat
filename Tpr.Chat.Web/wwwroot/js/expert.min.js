$(document).ready(function(){getAccessToken().then(function(n){const t=(new signalR.HubConnectionBuilder).withUrl("/chat?token="+n).configureLogging(signalR.LogLevel.Trace).build();t.start().catch(n=>console.error(n));t.on("Receive",(n,t)=>{const i=receiveMessage(n,t==="expert");$("#messagesList").append(i).scrollTo(i)});t.on("Join",(n,t,i,u)=>{const f=joinUser(n,t==="expert",i,u);$("#messagesList").append(f).scrollTo(f);r(i)});t.on("Leave",(n,t)=>{const i=leaveUser(n,t==="expert");$("#messagesList").append(i).scrollTo(i);r(!1)});$("#sendButton").on("click",()=>{t.invoke("SendMessage",$("#messageText").val()).catch(n=>console.error(n)),$("#messageText").val("")});const r=function(n){const t=n?"Подключен к чату":"Отключен от чата";$("#onlineStatus").text(t)},u=function(t){var r=luxon.Duration.fromMillis(t.remainingTime);$("#remainingTime").text(r.toFormat("mm 'минут'"));setTimeout(updateInfo,i,i,n,u)},i=1e4;updateInfo(i,n,u)}).catch(n=>alert(n))});